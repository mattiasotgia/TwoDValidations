[global]
group = icarus
experiment = icarus
wrapper = file:///${FIFE_UTILS_DIR}/libexec/fife_wrap
account = msotgia
file_type = data
run_type = physics
b_name = %(project_name)s
basename = override_me
larsoft_tag = override_me
larsoft_qual = override_me
sam_dataset = override_me
fcl = override_me
fcl_1 = override_me
fcl_2 = override_me
numevents = override_me
startevent = 1
outdir = override_me
logdir = override_me
streamname = only
fcl_list = override_me
stage_name = override_me
artRoot_dataset = %(project_name)s_%(stage_name)s
histRoot_dataset = hist_%(project_name)s_%(stage_name)s
project_name = msotgia_v10_06_00_07_BNB_stage0_1d_nue
release = v10_06_00_07
outloc = /pnfs/icarus/scratch/users/msotgia/twoDValidations/v10_06_00_07_develop/BNB/stageZeroOneDNoYZToCAF/NuE/
book = /pnfs/icarus/scratch/users/msotgia/twoDValidations/v10_06_00_07_develop/BNB/stageZeroOneDNoYZToCAF/NuE/

[env_pass]
IFDH_DEBUG = 1
IFDH_CP_MAXRETRIES = 2
EXPERIMENT=sbn
SAM_WEB_HOST = samsbn.fnal.gov
IFDH_BASE_URI=http://samsbn.fnal.gov:8480/sam/sbn/api/
SAM_EXPERIMENT=sbn
SAM_STATION=sbn
SAM_GROUP=sbn
ARTROOT_DATASET = %(artRoot_dataset)s
HISTROOT_DATASET = %(histRoot_dataset)s
XRD_CONNECTIONRETRY=32
XRD_REQUESTTIMEOUT=14400
XRD_REDIRECTLIMIT=255
XRD_LOADBALANCERTTL=7200
XRD_STREAMTIMEOUT=7200
IFDH_PROXY_ENABLE=0
IFDH_TOKEN_ENABLE=1

[prelaunch]
script = source /cvmfs/larsoft.opensciencegrid.org/products/setups; source /cvmfs/fermilab.opensciencegrid.org/products/common/etc/setups; setup project_py; ups active; Project.py --prestage --defname %(sam_dataset)s --experiment sbn

[submit]
G = %(group)s
e = SAM_EXPERIMENT
e_1 = IFDH_DEBUG
e_2 = POMS4_CAMPAIGN_NAME
e_3 = POMS4_CAMPAIGN_STAGE_NAME
e_4 = ARTROOT_DATASET
e_5 = HISTROOT_DATASET
line = '+SingularityImage=\"/cvmfs/singularity.opensciencegrid.org/fermilab/fnal-wn-sl7:latest\"'
debug = True
append_condor_requirements = '(TARGET.HAS_SINGULARITY=?=true)'
append_condor_requirements_1 = '((TARGET.HAS_CVMFS_fifeuser1_opensciencegrid_org==true)&&(CVMFS_fifeuser1_opensciencegrid_org_REVISION>=7792))'
resource-provides = override_me
generate-email-summary = True
expected-lifetime = 20h
disk = 32GB
memory = 6000MB
email-to = %(account)s@fnal.gov

[job_setup]
debug = True
find_setups = True
source_1 = /cvmfs/%(experiment)s.opensciencegrid.org/products/%(experiment)s/setup_%(experiment)s.sh
setup_1 = %(experiment)scode %(larsoft_tag)s -q %(larsoft_qual)s

[sam_consumer]
limit = 1
schema = root
appvers = %(larsoft_tag)s
appfamily = art
appname = test

[job_output]
addoutput = %(basename)s*.root
rename = unique
dest = %(outdir)s
hash = 2
declare_metadata = True
metadata_extractor = sam_metadata_dumper
add_location = True
filter_metadata = data_stream
filter_metadata_2 = art.run_type
filter_metadata_3 = art.file_format_era
filter_metadata_4 = art.last_event
filter_metadata_5 = art.process_name
filter_metadata_6 = art.first_event
filter_metadata_7 = art.file_format_version

[job_output_1]
addoutput = hist_%(basename)s*.root
rename = unique
dest = %(outdir)s
hash = 2
declare_metadata = True
add_location = True

[stage_stage0_stage1_caf]
job_output.add_to_dataset = %(artRoot_dataset)s
job_output.dataset_exclude = hist*
job_output.filter_metadata_1 = parents
job_output_1.add_to_dataset = %(histRoot_dataset)s
global.numevents = 500
global.larsoft_tag = %(release)s
global.larsoft_qual = e26:prof
job_setup.setup_local = True
job_output.addoutput = msotgia*.root
job_output_1.addoutput = hist*.root
submit.tar_file_name = dropbox:////exp/icarus/app/users/msotgia/devareas/dev_v10_devTwoDValidations/localProducts_icaruscode_v10_06_00_07_e26_prof/install.tar

global.fcl = stage0_run2_icarus_noyzsim_mc.fcl
global.fcl_1 = stage1_run2_1d_icarus_MC.fcl
global.fcl_2 = cafmakerjob_icarus_detsim2d.fcl
global.fcl_list = %(fcl_2)s/%(fcl_1)s/%(fcl)s

executable.name = lar
executable.arg_4 = %(basename)s_stage0_\${CLUSTER}_\${PROCESS}.root
executable.arg_10 = hist_%(basename)s_stage0_\${CLUSTER}_\${PROCESS}.root
executable.arg_6 = -1
executable.arg_7 =
executable.arg_8 = 
executable.arg_12 = 

executable_1.name = lar
executable_1.arg_4 = %(basename)s_stage1_\${CLUSTER}_\${PROCESS}.root
executable_1.arg_10 = hist_%(basename)s_stage1_\${CLUSTER}_\${PROCESS}.root
executable_1.arg_6 = -1
executable_1.arg_7 =
executable_1.arg_8 = 
executable_1.arg_12 = %(basename)s_stage0_\${CLUSTER}_\${PROCESS}.root

executable_2.name = lar
executable_2.arg_4 = %(basename)s_caf_\${CLUSTER}_\${PROCESS}.root
executable_2.arg_10 = hist_%(basename)s_caf_\${CLUSTER}_\${PROCESS}.root
executable_2.arg_6 = -1
executable_2.arg_7 =
executable_2.arg_8 = 
executable_2.arg_12 = %(basename)s_stage1_\${CLUSTER}_\${PROCESS}.root

global.basename = %(b_name)s_%(larsoft_tag)s
global.numjobs = 10
global.stage_name = stage0_stage1_caf
submit.N = %(numjobs)s
global.outdir = %(outloc)s/out
global.logdir = %(outloc)s/log
submit.memory = 6000MB
submit.lines  =  '+FERMIHTC_GraceMemory=2000'
submit.lines_1 = '+FERMIHTC_GraceLifetime=2000'
submit.lines_2 = '+FERMIHTC_AutoRelease=True'
submit.disk = 16GB
submit.n_files_per_job = 1
submit.resource-provides = usage_model=DEDICATED,OPPORTUNISTIC,OFFSITE
job_setup.ifdh_art = False
job_setup.multifile = True
submit.use-cvmfs-dropbox = True
sam_consumer.limit = 1
submit.dataset = msotgia_v10_06_00_07_BNB_productionToDetSimNuE_detsim
submit.expected-lifetime = 10h

[executable]
name = true
arg_1 = -c
arg_2 = %(fcl)s
arg_3 = -o
arg_4 = %(basename)s_gen_\${CLUSTER}_\${PROCESS}.root
arg_5 = -n
arg_6 = %(numevents)s
arg_7 = -e
arg_8 = 1:0:%(startevent)s
arg_9 = -T
arg_10 = hist_%(basename)s_gen_\${CLUSTER}_\${PROCESS}.root
arg_11 =
arg_12 =

[executable_1]
name = true
arg_1 = -c
arg_2 = %(fcl_1)s
arg_3 = -o
arg_4 = %(basename)s_gen_\${CLUSTER}_\${PROCESS}.root
arg_5 = -n
arg_6 = %(numevents)s
arg_7 = -e
arg_8 = 1:0:%(startevent)s
arg_9 = -T
arg_10 = hist_%(basename)s_gen_\${CLUSTER}_\${PROCESS}.root
arg_11 =
arg_12 =

[executable_2]
name = true
arg_1 = -c
arg_2 = %(fcl_2)s
arg_3 = -o
arg_4 = %(basename)s_gen_\${CLUSTER}_\${PROCESS}.root
arg_5 = -n
arg_6 = %(numevents)s
arg_7 = -e
arg_8 = 1:0:%(startevent)s
arg_9 = -T
arg_10 = hist_%(basename)s_gen_\${CLUSTER}_\${PROCESS}.root
arg_11 =
arg_12 =